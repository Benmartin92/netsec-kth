%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%2345678901234567890123456789012345678901234567890123456789012345678901234567890
%        1         2         3         4         5         6         7         8

\documentclass[letterpaper, 10 pt, conference]{ieeeconf}  % Comment this line out
                                                          % if you need a4paper
%\documentclass[a4paper, 10pt, conference]{ieeeconf}      % Use this line for a4
                                                          % paper

\IEEEoverridecommandlockouts                              % This command is only
                                                          % needed if you want to
                                                          % use the \thanks command
                                                          \usepackage[utf8]{inputenc}
\usepackage[utf8]{inputenc}
\overrideIEEEmargins
% See the \addtolength command later in the file to balance the column lengths
% on the last page of the document



% The following packages can be found on http:\\www.ctan.org
%\usepackage{graphics} % for pdf, bitmapped graphics files
%\usepackage{epsfig} % for postscript graphics files
%\usepackage{mathptmx} % assumes new font selection scheme installed
%\usepackage{times} % assumes new font selection scheme installed
\usepackage{amsmath} % assumes amsmath package installed
\usepackage{amssymb}  % assumes amsmath package installed
\usepackage{fancyhdr}
\setlength{\headheight}{15.2pt}
\usepackage[]{algorithm2e}
\usepackage{url}

\newtheorem{thm}{Theorem}
\newtheorem{lem}{Lemma}
\newtheorem{defi}{Definition}
\newtheorem{prop}{Proposition}

\title{\LARGE \bf
%modif
On the vulnerabilities of the DHCP protocol
}

\author{Benj√°min Martin Seregi$^{1}$% <-this % stops a space
% \thanks{*This work was not supported by any organization}% <-this % stops a space
\thanks{$^{1}$ e-mail: seregi@kth.se}%
}

\begin{document}


\maketitle
\thispagestyle{fancy}
\fancyhf{}
\chead{KTH Royal Institute of Technology | EP2510, Fall 2017, Period 2 | \today}

\begin{abstract}
The Dynamic Host Configuration Protocol (DHCP) is a widely used protocol for dynamically distributing Internet (IP) addresses. The protocol is also responsible for the dynamic distribution of the DNS server and gateway addresses. Due its unauthenticated communication, man-in-the-middle attacks can be carried out by rogue DHCP servers providing malicious DNS or gateway addresses. In this report we investigate the state-of-the-art techniques that mitigate DHCP attacks and we propose a new extension of the DHCP protocol that protects against rogue DHCP servers. In addition, we implement this extension using the INET Framework and run simulations in OMNeT++.
\end{abstract}

\begin{keywords}
DHCP, rogue DHCP server, DHCP authentication, DHCP spoofing, DHCP security
\end{keywords}
% TODO: dhcp snooping, dhcp authentication: with public key crypthography,
% wlc, description of the different attacks
% unicast / broadcast client-server communication (broadcast flag in DHCP)
% https://www.cisco.com/c/en/us/td/docs/solutions/Enterprise/Mobility/emob41dg/emob41dg-wrapper/ch4_Secu.html#wp1019184

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
%Describe the background for chosen area that is going to be investigated. Write a short description of the area that is going to be %investigated. It is a brief description of the necessary background knowledge of the problem area and for carrying out the project.
The Dynamic Host Configuration Protocol is a widely used protocol for dynamically distributing Internet addresses \cite{dhcprfc}. DHCP works in a client-server architecture where the client (DHCP client) requests an IP address and the server (DHCP server) allocates IPs from the pool of available addresses. The communication between these two entities is unauthenticated \cite{dhcprfc} which imposes several security issues. Rogue DHCP server can be easily set up that might offer the clients malicious default gateways or DNS servers (see \cite{dhcprfc}, DHCPOFFER message) that can lead to denial-of-service or man-in-the-middle attacks \cite{Rooney:2010:IIA:1951974} (9 Security Considerations). In addition, the lack of authentication allows the attacker to exhaust the pool of available addresses by continuously requesting new IPs using fake MAC addresses and request DHCP operations (e.g. DHCP lease) on behalf of other clients by fabricating DHCP messages with sniffed MAC addresses (hijacking) \cite{practical-embedded-security} (Chapter 2).

In this report we overview the state-of-the-art countermeasures against DHCP attacks. We also introduce a new extension of the DHCP protocol that prevents man-in-the-middle attacks. In addition, we implement this extension using the open-source INET Framework \cite{inet} and run simulations in OMNeT++ \cite{Varga:2008:OOS:1416222.1416290}. The aim of the simulations is to show how DHCP vulnerabilities can lead to man-in-the-middle attacks and to demonstrate that this new extension can prevent them. The rest of the report is organized as follows.

Section \ref{sec:man-in-the-middle} describes a possible man-in-the-middle attack when we use the base protocol, that is, the RFC 2131 without any additional modifications. In Section \ref{sec:dhcp-snooping}, we discuss the DHCP snooping technique which is a L2 security tool against DHCP hijacking and rogue DHCP servers. In Section \ref{sec:auth}, we investigate the different DHCP authentication techniques with a high focus on public key cryptography. In Section \ref{sec:protected-mode}, we introduce a possible extension of the existing DHCP implementation that protects against rogue DHCP servers.
\section{A man-in-the-middle attack}\label{sec:man-in-the-middle}
\section{DHCP Snooping}\label{sec:dhcp-snooping}
\section{DHCP authentication methods}\label{sec:auth}
\section{A new extension: DHCP Protected Mode}\label{sec:protected-mode}

\addtolength{\textheight}{-12cm}   % This command serves to balance the column lengths
                                  % on the last page of the document manually. It shortens
                                  % the textheight of the last page by a suitable amount.
                                  % This command does not take effect until the next page
                                  % so it should come on the page before the last. Make
                                  % sure that you do not shorten the textheight too much.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\bibliographystyle{IEEEtran}
\bibliography{ref.bib}
\end{document}